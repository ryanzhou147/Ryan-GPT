{
  "world_size": 4,
  "backend": "gloo",
  "results": [
    {
      "name": "DDPFlat (your ddp_flat.py)",
      "strategy": "ddp_flat",
      "use_sharded_optimizer": false,
      "use_mixed_precision": true,
      "total_time_sec": 11.330995280004572,
      "steps_per_sec": 1.7650700142196096,
      "tokens_per_sec": 28918.907112974084,
      "peak_memory_mb": 1276.68994140625,
      "allocated_memory_mb": 492.28955078125,
      "final_loss": 320.43013229370115,
      "weights_synchronized": true,
      "error": null
    },
    {
      "name": "DDPBucketed (your ddp_bucket.py)",
      "strategy": "ddp_bucketed",
      "use_sharded_optimizer": false,
      "use_mixed_precision": true,
      "total_time_sec": 10.09777808799845,
      "steps_per_sec": 1.9806337419685105,
      "tokens_per_sec": 32450.703228412076,
      "peak_memory_mb": 1631.01416015625,
      "allocated_memory_mb": 843.92236328125,
      "final_loss": 269.54188976287844,
      "weights_synchronized": true,
      "error": null
    },
    {
      "name": "DDPFlat + ZeRO",
      "strategy": "ddp_flat",
      "use_sharded_optimizer": true,
      "use_mixed_precision": true,
      "total_time_sec": 11.870092596996983,
      "steps_per_sec": 1.6849068224674004,
      "tokens_per_sec": 27605.51337930589,
      "peak_memory_mb": 1360.86181640625,
      "allocated_memory_mb": 577.86767578125,
      "final_loss": 345.170050239563,
      "weights_synchronized": true,
      "error": null
    },
    {
      "name": "DDPBucketed + ZeRO",
      "strategy": "ddp_bucketed",
      "use_sharded_optimizer": true,
      "use_mixed_precision": true,
      "total_time_sec": 10.76056024099671,
      "steps_per_sec": 1.858639285694615,
      "tokens_per_sec": 30451.946056820572,
      "peak_memory_mb": 1717.78759765625,
      "allocated_memory_mb": 932.88720703125,
      "final_loss": 308.4611888885498,
      "weights_synchronized": true,
      "error": null
    },
    {
      "name": "TensorParallel (your TP)",
      "strategy": "tensor_parallel",
      "use_sharded_optimizer": false,
      "use_mixed_precision": true,
      "total_time_sec": 6.797269859998778,
      "steps_per_sec": 2.942357801283999,
      "tokens_per_sec": 48207.59021623704,
      "peak_memory_mb": 1029.77197265625,
      "allocated_memory_mb": 669.00439453125,
      "final_loss": 9.302617645263672,
      "weights_synchronized": false,
      "error": null
    },
    {
      "name": "PyTorch DDP (baseline)",
      "strategy": "torch_ddp",
      "use_sharded_optimizer": false,
      "use_mixed_precision": true,
      "total_time_sec": 9.706084500001452,
      "steps_per_sec": 2.0605631446951658,
      "tokens_per_sec": 33760.266562685596,
      "peak_memory_mb": 1873.82275390625,
      "allocated_memory_mb": 1088.46533203125,
      "final_loss": 272.1387247085571,
      "weights_synchronized": true,
      "error": null
    },
    {
      "name": "PyTorch FSDP (baseline)",
      "strategy": "fsdp",
      "use_sharded_optimizer": false,
      "use_mixed_precision": true,
      "total_time_sec": 10.853518981995876,
      "steps_per_sec": 1.8427203226139435,
      "tokens_per_sec": 30191.12976570685,
      "peak_memory_mb": 1158.36669921875,
      "allocated_memory_mb": 613.90869140625,
      "final_loss": 236.3,
      "weights_synchronized": false,
      "error": null
    },
    {
      "name": "PyTorch DDP + ZeRO",
      "strategy": "torch_ddp",
      "use_sharded_optimizer": true,
      "use_mixed_precision": true,
      "total_time_sec": 10.4757375650006,
      "steps_per_sec": 1.9091734473016893,
      "tokens_per_sec": 31279.897760590877,
      "peak_memory_mb": 1721.78759765625,
      "allocated_memory_mb": 935.94189453125,
      "final_loss": 306.40964393615724,
      "weights_synchronized": true,
      "error": null
    }
  ]
}